!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.ElementLite={})}(this,function(e){"use strict";let t,n,i,o;const a=(e,a)=>{if(void 0===t){t=!1;try{var h=new window.URL("b","http://a");h.pathname="c%20d",t=(t="http://a/c%20d"===h.href)&&"http://www.google.com/?foo%20bar"===new window.URL("http://www.google.com/?foo bar").href}catch(e){console.error(e)}}return t?new window.URL(e,a):(n||(n=document.implementation.createHTMLDocument("url"),i=n.createElement("base"),n.head.appendChild(i),o=n.createElement("a")),i.href=a,o.href=e.replace(/ /g,"%20"),o)};class h extends window.HTMLElement{static get is(){return"location-lite"}constructor(){super(),this.__data={},this._boundHashChanged=this._hashChanged.bind(this),this._boundUrlChanged=this._urlChanged.bind(this),this._boundGlobalOnClick=this._globalOnClick.bind(this),this._urlSpaceRegExp=null,this.dwellTime=2e3}connectedCallback(){window.addEventListener("hashchange",this._boundHashChanged),window.addEventListener("location-change",this._boundUrlChanged),window.addEventListener("popstate",this._boundUrlChanged),document.body.addEventListener("click",this._boundGlobalOnClick,!0),window.performance&&(this._lastChangedAt=window.performance.now()-(this.dwellTime-200)),this._initialized=!0,this._urlChanged()}disconnectedCallback(){window.removeEventListener("hashchange",this._boundHashChanged),window.removeEventListener("location-change",this._boundUrlChanged),window.removeEventListener("popstate",this._boundUrlChanged),document.body.removeEventListener("click",this._boundGlobalOnClick),this._initialized=!1}set urlSpaceRegex(e){this.__data.urlSpaceRegex=e,this._urlSpaceRegExp=RegExp(e)}get urlSpaceRegex(){return this.__data.urlSpaceRegex}_hashChanged(){this.hash=window.decodeURIComponent(window.location.hash.slice(1)),this.dispatchEvent(new window.CustomEvent("hash-change",{detail:this.hash}))}_urlChanged(){this._dontUpdateUrl=!0,this._hashChanged(),this.path=window.decodeURIComponent(window.location.pathname),this.dispatchEvent(new window.CustomEvent("path-change",{detail:this.path})),this.query=window.location.search.slice(1),this.dispatchEvent(new window.CustomEvent("query-change",{detail:this.query})),this._dontUpdateUrl=!1,this._updateUrl()}_getUrl(){var e=window.encodeURI(this.path).replace(/\#/g,"%23").replace(/\?/g,"%3F"),t="";this.query&&(t="?"+this.query.replace(/\#/g,"%23"));var n="";return this.hash&&(n="#"+window.encodeURI(this.hash)),e+t+n}_updateUrl(){if(!this._dontUpdateUrl&&this._initialized&&(this.path!==window.decodeURIComponent(window.location.pathname)||this.query!==window.location.search.substring(1)||this.hash!==window.decodeURIComponent(window.location.hash.substring(1)))){var e=this._getUrl(),t=a(e,window.location.protocol+"//"+window.location.host).href,n=window.performance?window.performance.now():null,i=this._lastChangedAt+this.dwellTime>n;this._lastChangedAt=n,i?window.history.replaceState({},"",t):window.history.pushState({},"",t),window.dispatchEvent(new window.CustomEvent("location-change"))}}_globalOnClick(e){if(!e.defaultPrevented){var t=this._getSameOriginLinkHref(e);t&&(e.preventDefault(),t!==window.location.href&&(window.history.pushState({},"",t),window.dispatchEvent(new window.CustomEvent("location-change"))))}}_getSameOriginLinkHref(e){if(0!==e.button)return null;if(e.metaKey||e.ctrlKey)return null;const t=e.composedPath();let n=null;for(var i=0;i<t.length;i++){var o=t[i];if("A"===o.tagName&&o.href){n=o;break}}if(!n)return null;if("_blank"===n.target)return n.href&&window.ga&&window.ga("send","event","Link","Click",n.href,1),null;if(("_top"===n.target||"_parent"===n.target)&&window.top!==window)return null;const h=n.href;let d,s,r;if(d=null!=document.baseURI?a(h,document.baseURI):a(h),s=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,(r=d.origin?d.origin:d.protocol+"//"+d.host)!==s)return null;var l=d.pathname+d.search+d.hash;return"/"!==l[0]&&(l="/"+l),this._urlSpaceRegExp&&!this._urlSpaceRegExp.test(l)?null:a(l,window.location.href).href}}window.customElements.get(h.is)?console.warn(`${h.is} is already defined somewhere. Please check your code.`):window.customElements.define(h.is,h),e.LocationLite=h,Object.defineProperty(e,"__esModule",{value:!0})});
