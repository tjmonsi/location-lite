!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.LocationLite={})}(this,function(e){"use strict";var t,n,i,o,a=function(e,a){if(void 0===t){t=!1;try{var r=new window.URL("b","http://a");r.pathname="c%20d",t=(t="http://a/c%20d"===r.href)&&"http://www.google.com/?foo%20bar"===new window.URL("http://www.google.com/?foo bar").href}catch(e){console.error(e)}}return t?new window.URL(e,a):(n||(n=document.implementation.createHTMLDocument("url"),i=n.createElement("base"),n.head.appendChild(i),o=n.createElement("a")),i.href=a,o.href=e.replace(/ /g,"%20"),o)},r=function(e){function t(){e.call(this),this.__data={},this.__dataInvalid=!1,this._boundHashChanged=this._hashChanged.bind(this),this._boundUrlChanged=this._urlChanged.bind(this),this._boundGlobalOnClick=this._globalOnClick.bind(this),this._urlSpaceRegExp=null,this.dwellTime=2e3}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={urlSpaceRegex:{configurable:!0},path:{configurable:!0},query:{configurable:!0},hash:{configurable:!0}},i={is:{configurable:!0}};return i.is.get=function(){return"location-lite"},t.prototype.connectedCallback=function(){window.addEventListener("hashchange",this._boundHashChanged),window.addEventListener("location-change",this._boundUrlChanged),window.addEventListener("popstate",this._boundUrlChanged),document.body.addEventListener("click",this._boundGlobalOnClick,!0),window.performance&&(this._lastChangedAt=window.performance.now()-(this.dwellTime-200)),this._initialized=!0,this._urlChanged()},t.prototype.disconnectedCallback=function(){window.removeEventListener("hashchange",this._boundHashChanged),window.removeEventListener("location-change",this._boundUrlChanged),window.removeEventListener("popstate",this._boundUrlChanged),document.body.removeEventListener("click",this._boundGlobalOnClick),this._initialized=!1},n.urlSpaceRegex.set=function(e){this.__data.urlSpaceRegex=e,this._urlSpaceRegExp=RegExp(e)},n.urlSpaceRegex.get=function(){return this.__data.urlSpaceRegex},n.path.set=function(e){this.__data.path!==e&&(this.__data.path=e,this._invalidateProperties())},n.path.get=function(){return this.__data.path},n.query.set=function(e){this.__data.query!==e&&(this.__data.query=e,this._invalidateProperties())},n.query.get=function(){return this.__data.query},n.hash.set=function(e){this.__data.hash!==e&&(this.__data.hash=e,this._invalidateProperties())},n.hash.get=function(){return this.__data.hash},t.prototype._invalidateProperties=function(){var e=this;this.__dataInvalid||(this.__dataInvalid=!0,Promise.resolve().then(function(){e.__dataInvalid&&(e.__dataInvalid=!1,e._updateUrl())}))},t.prototype._hashChanged=function(){var e=this;this.hash=window.decodeURIComponent(window.location.hash.slice(1)),Promise.resolve().then(function(){e.dispatchEvent(new window.CustomEvent("hash-change",{detail:e.hash}))})},t.prototype._urlChanged=function(){var e=this;this._dontUpdateUrl=!0,this._hashChanged(),this.path=window.decodeURIComponent(window.location.pathname),this.query=window.location.search.slice(1),Promise.resolve().then(function(){e.dispatchEvent(new window.CustomEvent("path-change",{detail:e.path})),e.dispatchEvent(new window.CustomEvent("query-change",{detail:e.query}))}),this._dontUpdateUrl=!1},t.prototype._getUrl=function(){var e=window.encodeURI(this.path).replace(/\#/g,"%23").replace(/\?/g,"%3F"),t="";this.query&&(t="?"+this.query.replace(/\#/g,"%23"));var n="";return this.hash&&(n="#"+window.encodeURI(this.hash)),e+t+n},t.prototype._updateUrl=function(){if(!this._dontUpdateUrl&&this._initialized&&(this.path!==window.decodeURIComponent(window.location.pathname)||this.query!==window.location.search.substring(1)||this.hash!==window.decodeURIComponent(window.location.hash.substring(1)))){var e=this._getUrl(),t=a(e,window.location.protocol+"//"+window.location.host).href,n=window.performance?window.performance.now():null,i=this._lastChangedAt+this.dwellTime>n;this._lastChangedAt=n,i?window.history.replaceState({},"",t):window.history.pushState({},"",t),window.dispatchEvent(new window.CustomEvent("location-change"))}},t.prototype._globalOnClick=function(e){if(!e.defaultPrevented){var t=this._getSameOriginLinkHref(e);t&&(e.preventDefault(),t!==window.location.href&&(window.history.pushState({},"",t),window.dispatchEvent(new window.CustomEvent("location-change"))))}},t.prototype._getSameOriginLinkHref=function(e){if(0!==e.button)return null;if(e.metaKey||e.ctrlKey)return null;for(var t=e.composedPath(),n=null,i=0;i<t.length;i++){var o=t[i];if("A"===o.tagName&&o.href){n=o;break}}if(!n)return null;if("_blank"===n.target)return n.href&&window.ga&&window.ga("send","event","Link","Click",n.href,1),null;if(("_top"===n.target||"_parent"===n.target)&&window.top!==window)return null;var r,h,d=n.href;if(r=null!=document.baseURI?a(d,document.baseURI):a(d),h=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,(r.origin?r.origin:r.protocol+"//"+r.host)!==h)return null;var s=r.pathname+r.search+r.hash;return"/"!==s[0]&&(s="/"+s),this._urlSpaceRegExp&&!this._urlSpaceRegExp.test(s)?null:a(s,window.location.href).href},Object.defineProperties(t.prototype,n),Object.defineProperties(t,i),t}(window.HTMLElement);window.customElements.get(r.is)?console.warn(`${r.is} is already defined somewhere. Please check your code.`):window.customElements.define(r.is,r),e.LocationLite=r,Object.defineProperty(e,"__esModule",{value:!0})});