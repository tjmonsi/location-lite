!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.ElementLite={})}(this,function(e){"use strict";var t,n,o,i,a=function(e,a){if(void 0===t){t=!1;try{var h=new window.URL("b","http://a");h.pathname="c%20d",t=(t="http://a/c%20d"===h.href)&&"http://www.google.com/?foo%20bar"===new window.URL("http://www.google.com/?foo bar").href}catch(e){console.error(e)}}return t?new window.URL(e,a):(n||(n=document.implementation.createHTMLDocument("url"),o=n.createElement("base"),n.head.appendChild(o),i=n.createElement("a")),o.href=a,i.href=e.replace(/ /g,"%20"),i)},h=function(e){function t(){e.call(this),this._boundHashChanged=this._hashChanged.bind(this),this._boundUrlChanged=this._urlChanged.bind(this),this._boundGlobalOnClick=this._globalOnClick.bind(this),this._urlSpaceRegExp=null}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={is:{configurable:!0}};return n.is.get=function(){return"location-lite"},t.prototype.connectedCallback=function(){window.addEventListener("hashchange",this._boundHashChanged),window.addEventListener("location-change",this._boundUrlChanged),window.addEventListener("popstate",this._boundUrlChanged),document.body.addEventListener("click",this._boundGlobalOnClick,!0),window.performance&&(this._lastChangedAt=window.performance.now()-(this.dwellTime-200)),this._initialized=!0,this.dwellTime=2e3,this._initialized=!1,this._urlChanged()},t.prototype.disconnectedCallback=function(){window.removeEventListener("hashchange",this._boundHashChanged),window.removeEventListener("location-change",this._boundUrlChanged),window.removeEventListener("popstate",this._boundUrlChanged),document.body.removeEventListener("click",this._boundGlobalOnClick),this._initialized=!1},t.prototype._hashChanged=function(){this.hash=window.decodeURIComponent(window.location.hash.slice(1)),this.dispatchEvent(new window.CustomEvent("hash-change",{detail:this.hash}))},t.prototype._urlChanged=function(){this._dontUpdateUrl=!0,this._hashChanged(),this.path=window.decodeURIComponent(window.location.pathname),this.dispatchEvent(new window.CustomEvent("path-change",{detail:this.path})),this.query=window.location.search.slice(1),this.dispatchEvent(new window.CustomEvent("query-change",{detail:this.query})),this._dontUpdateUrl=!1,this._updateUrl()},t.prototype._getUrl=function(){var e=window.encodeURI(this.path).replace(/\#/g,"%23").replace(/\?/g,"%3F"),t="";this.query&&(t="?"+this.query.replace(/\#/g,"%23"));var n="";return this.hash&&(n="#"+window.encodeURI(this.hash)),e+t+n},t.prototype._updateUrl=function(){if(!this._dontUpdateUrl&&this._initialized&&(this.path!==window.decodeURIComponent(window.location.pathname)||this.query!==window.location.search.substring(1)||this.hash!==window.decodeURIComponent(window.location.hash.substring(1)))){var e=this._getUrl(),t=a(e,window.location.protocol+"//"+window.location.host).href,n=window.performance?window.performance.now():null,o=this._lastChangedAt+this.dwellTime>n;this._lastChangedAt=n,o?window.history.replaceState({},"",t):window.history.pushState({},"",t),window.dispatchEvent(new window.CustomEvent("location-change"))}},t.prototype._globalOnClick=function(e){if(!e.defaultPrevented){var t=this._getSameOriginLinkHref(e);t&&(e.preventDefault(),t!==window.location.href&&(window.history.pushState({},"",t),window.dispatchEvent(new window.CustomEvent("location-change"))))}},t.prototype._getSameOriginLinkHref=function(e){if(0!==e.button)return null;if(e.metaKey||e.ctrlKey)return null;for(var t=e.composedPath(),n=null,o=0;o<t.length;o++){var i=t[o];if("A"===i.tagName&&i.href){n=i;break}}if(!n)return null;if("_blank"===n.target)return n.href&&window.ga&&window.ga("send","event","Link","Click",n.href,1),null;if(("_top"===n.target||"_parent"===n.target)&&window.top!==window)return null;var h,r,d=n.href;if(h=null!=document.baseURI?a(d,document.baseURI):a(d),r=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,(h.origin?h.origin:h.protocol+"//"+h.host)!==r)return null;var s=h.pathname+h.search+h.hash;return"/"!==s[0]&&(s="/"+s),this._urlSpaceRegExp&&!this._urlSpaceRegExp.test(s)?null:a(s,window.location.href).href},Object.defineProperties(t,n),t}(window.HTMLElement);window.customElements.get(h.is)?console.warn(`${h.is} is already defined somewhere. Please check your code.`):window.customElements.define(h.is,h),e.LocationLite=h,Object.defineProperty(e,"__esModule",{value:!0})});
